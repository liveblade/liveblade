/*!
 * LiveBlade v2.0.0
 * Production-ready AJAX for Laravel Blade
 * @license MIT
 *
 * Included:
 *   - core
 *   - html-controller
 *   - rate-limiter
 *   - state
 *   - html
 *   - nav
 *   - search
 *   - filter
 *   - sort
 *   - button
 *   - toggle
 *   - data
 *   - pagination
 *   - quick-search
 *   - cascade
 */
!function(e,t){"use strict";if(e.LiveBlade)return;const s="1.0.1",i="1"===localStorage.getItem("lb_debug");function r(...e){i&&console.log("[LiveBlade]",...e)}function n(...e){console.warn("[LiveBlade]",...e)}function a(...e){console.error("[LiveBlade]",...e)}let l=0;const o={version:s,controllers:new WeakMap,instances:new Set,config:{debounce:300,throttle:100,retryDelay:2e3,maxRetries:3,requestTimeout:3e4,skeletonHTML:null,errorHTML:null,successDuration:1500,errorDuration:3e3,updateUrl:!1,updateUrlMode:"push",preserveScroll:!0,preserveInputs:!0,preserveFocus:!0,smartUpdate:!0,contentHashLength:500},csrf:null,_events:Object.create(null),_features:Object.create(null),_binders:Object.create(null),_initialized:!1};var d;o.utils={log:r,warn:n,error:a,escapeHtml:e=>null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),cssEscape:e=>null==e?"":"undefined"!=typeof CSS&&CSS.escape?CSS.escape(e):String(e).replace(/([^\w-])/g,"\\$1"),sameOrigin:function(t){try{return new URL(t,e.location.href).origin===e.location.origin}catch{return!1}},uniqueId:function(e="lb"){return`${e}_${++l}_${Date.now().toString(36)}`},debounce:function(e,t){let s;return function(...i){clearTimeout(s),s=setTimeout(()=>e.apply(this,i),t)}},throttle:function(e,t){let s;return function(...i){s||(e.apply(this,i),s=!0,setTimeout(()=>s=!1,t))}},parseUrl:function(t){try{const s=new URL(t,e.location.href);return{path:s.pathname,params:Object.fromEntries(s.searchParams.entries()),hash:s.hash}}catch{return{path:"/",params:{},hash:""}}},buildUrl:function(t,s,i=""){const r=new URL(t,e.location.href);return r.search="",Object.entries(s).forEach(([e,t])=>{null!=t&&""!==t&&r.searchParams.set(e,t)}),r.pathname+r.search+(i||"")}},o.refreshCsrf=function(){return this.csrf=t.querySelector('meta[name="csrf-token"]')?.content||"",this.csrf||n("CSRF token not found."),this},o.getCsrf=function(){return this.csrf||this.refreshCsrf(),this.csrf},o.on=function(e,t){return"function"!=typeof t||(this._events[e]||=[]).push(t),this},o.off=function(e,t){return this._events[e]?(t?this._events[e]=this._events[e].filter(e=>e!==t):delete this._events[e],this):this},o.emit=function(e,t){return(this._events[e]||[]).forEach(e=>{try{e(t)}catch(e){a("Event listener error:",e)}}),this},o.once=function(e,t){const s=i=>{this.off(e,s),t(i)};return this.on(e,s)},o.use=function(e,t={}){return"function"==typeof e?e(this,t):e?.install&&e.install(this,t),this},o.registerFeature=function(e,t){return this._features[e]?(n(`Feature "${e}" already registered.`),this):(this._features[e]=t,"function"==typeof t.init&&t.init(this),r(`Feature "${e}" registered.`),this)},o.hasFeature=function(e){return!!this._features[e]},o.registerBinder=function(e,t){return this._binders[e]?(n(`Binder "${e}" already registered.`),this):(this._binders[e]=t,r(`Binder "${e}" registered.`),this)},o.resolve=function(e){if(!e)return null;const s=e.getAttribute("data-lb-target");if(s){const e=t.querySelector(s);return e?o.controllers.get(e):null}const i=e.closest('[data-lb="html"], [data-lb-html], [data-lb-container]');return i?o.controllers.get(i):null},o.bind=function(e=t){return Object.entries(this._binders).forEach(([t,s])=>{if(!s.selector)return;e.querySelectorAll(`${s.selector}:not([data-lb-bound~="${t}"])`).forEach(e=>{try{s.bind(e,this);const i=e.getAttribute("data-lb-bound")||"";e.setAttribute("data-lb-bound",(i+" "+t).trim())}catch(e){a(`Binder "${t}" error:`,e)}})}),this},o.refresh=function(e){if("string"==typeof e){const s=o.controllers.get(t.querySelector(e));s&&s.refresh()}else if(e instanceof HTMLElement){const t=o.controllers.get(e);t&&t.refresh()}else o.instances.forEach(e=>e.refresh());return this},o.cleanup=function(e=t){return e.querySelectorAll("[data-lb-bound]").forEach(e=>{const t=o.controllers.get(e);t?.dispose&&t.dispose(),o.controllers.delete(e),e.removeAttribute("data-lb-bound"),e._lbDataTimer&&(clearInterval(e._lbDataTimer),delete e._lbDataTimer)}),this},o.configure=function(e){return e&&"object"==typeof e&&Object.assign(o.config,e),this},o.debug=function(e=!0){return localStorage.setItem("lb_debug",e?"1":"0"),console.log("[LiveBlade] Debug mode "+(e?"enabled":"disabled")+". Reload page."),this},o.test=function(e){const s="string"==typeof e?t.querySelector(e):e;if(!s)return console.log("âŒ Not found:",e),null;console.log("âœ… Found:",s);const i=o.resolve(s);return i&&console.log("ðŸŽ® Controller:",i.id,i.getUrl()),{el:s,ctrl:i}},o.getController=function(e){const s="string"==typeof e?t.querySelector(e):e;return s?o.controllers.get(s):null},o.getAllControllers=()=>Array.from(o.instances),o.init=function(){return this._initialized||(this._initialized=!0,this.refreshCsrf(),t.addEventListener("csrf-token-update",()=>this.refreshCsrf()),this.bind(),r("Initialized v"+s),this.emit("init")),this},d=()=>o.init(),"loading"===t.readyState?t.addEventListener("DOMContentLoaded",d):d(),e.LiveBlade=o}(window,document),function(e){"use strict";function t(e){let t=0;for(let s=0;s<e.length;s++)t=(t<<5)-t+e.charCodeAt(s),t&=t;return t}function s(e,t){this.el=e,this.LiveBlade=t,this.id=t.utils.uniqueId("ctrl"),this.path="/",this.params={},this.hash="",this.abortController=null,this.timeoutId=null,this.refreshTimer=null,this.requestId=0,this.retryCount=0,this.lastHTML=null,this._historyInitialized=!1,this._disposed=!1,e.getAttribute("role")||e.setAttribute("role","region"),e.getAttribute("aria-live")||e.setAttribute("aria-live","polite"),t.instances.add(this),this._initFromAttributes()}s.prototype._initFromAttributes=function(){const e=this.el,t=e.getAttribute("data-lb-fetch")||e.getAttribute("data-lb-html")||e.getAttribute("data-lb");t&&"html"!==t&&this.setUrl(t);const s=parseInt(e.getAttribute("data-lb-interval"),10);s>0&&(this.refreshTimer=setInterval(()=>{this._disposed||this.refresh()},1e3*s)),t&&"html"!==t&&this.load(!1,{pushState:!1,isInitial:!0})},s.prototype.setUrl=function(e){const{sameOrigin:t,parseUrl:s}=this.LiveBlade.utils;if(!e||!t(e))return this;const i=s(e);return this.path=i.path,this.params=i.params,this.hash=i.hash,this},s.prototype.updateParam=function(e,t){return null==t||""===t?delete this.params[e]:this.params[e]=String(t),this},s.prototype.updateParams=function(e){return Object.entries(e).forEach(([e,t])=>this.updateParam(e,t)),this},s.prototype.resetPage=function(){return delete this.params.page,this},s.prototype.getUrl=function(){return this.LiveBlade.utils.buildUrl(this.path,this.params,this.hash)},s.prototype.showSkeleton=function(){this.el.innerHTML.trim()||(this.el.innerHTML=this.LiveBlade.config.skeletonHTML||'\n            <div class="lb-skeleton" role="status" aria-label="Loading">\n                <div class="lb-skeleton-line"></div>\n                <div class="lb-skeleton-line" style="width:90%"></div>\n                <div class="lb-skeleton-line" style="width:75%"></div>\n            </div>\n        ')},s.prototype.setLoading=function(e){this.el.classList.toggle("lb-loading",e),this.el.setAttribute("aria-busy",e?"true":"false"),this.LiveBlade.emit(e?"loading:start":"loading:end",{controller:this})},s.prototype.abortPendingRequest=function(){this.abortController&&(this.abortController.abort(),this.abortController=null),this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null)},s.prototype.load=async function(s=!1,i={}){if(this._disposed)return;const{sameOrigin:r,log:n,escapeHtml:a}=this.LiveBlade.utils,l=this.LiveBlade.config,o=this.getUrl();if(!o||!r(o))return;if(this.LiveBlade.rateLimiter&&!this.LiveBlade.rateLimiter.canRequest(o))return;this.requestId+=1;const d=this.requestId;i.isInitial&&!s&&this.showSkeleton(),this.abortPendingRequest(),this.abortController=new AbortController,this.timeoutId=setTimeout(()=>{this.abortController&&this.abortController.abort()},l.requestTimeout);const c=this.el.innerHTML,h=this.LiveBlade.state?.saveAll(this.el,l);let u,p;this.setLoading(!0),n("Fetching:",o);try{u=await fetch(o,{method:"GET",headers:{"X-Requested-With":"XMLHttpRequest","X-LiveBlade":"true",Accept:"application/json, text/html","X-CSRF-TOKEN":this.LiveBlade.getCsrf()},credentials:"same-origin",signal:this.abortController.signal})}catch(e){if(this.timeoutId&&clearTimeout(this.timeoutId),"AbortError"===e.name)return;return void this.handleError(e,o,s)}if(this.timeoutId&&clearTimeout(this.timeoutId),d!==this.requestId)return;try{if(u.redirected)return void(e.location.href=u.url);if(!u.ok)throw new Error(`HTTP ${u.status}`);p=(u.headers.get("content-type")||"").includes("application/json")?await u.json():{html:await u.text(),has_more:!1}}catch(e){return void this.handleError(e,o,s)}finally{this.setLoading(!1)}const b="string"==typeof p.html?p.html:"",f=!!p.has_more,m=s||!l.smartUpdate||function(e,s,i=500){return!(e===s||e&&s&&e.length===s.length&&e.slice(0,i)===s.slice(0,i)&&e.slice(-i)===s.slice(-i)&&t(e)===t(s))}(c,b,l.contentHashLength);if(s?this.el.insertAdjacentHTML("beforeend",b):m&&(this.el.innerHTML=b,this.lastHTML=b),this.el.dataset.lbHasMore=f?"1":"0",this.retryCount=0,m&&this.LiveBlade.bind(this.el),!s&&h&&this.LiveBlade.state?.restoreAll(this.el,h),!s&&i.pushState&&e.history&&l.updateUrl){const t=this.getUrl(),s={liveblade:!0,controllerId:this.id,path:this.path,params:{...this.params}};!this._historyInitialized||i.replaceState||"replace"===l.updateUrlMode?(e.history.replaceState(s,"",t),this._historyInitialized=!0):e.history.pushState(s,"",t)}this.el.dispatchEvent(new CustomEvent("lb:loaded",{detail:{url:o,data:p,append:s},bubbles:!0})),this.LiveBlade.emit("loaded",{controller:this,url:o,data:p,append:s,changed:m})},s.prototype.handleError=function(e,t,s){if(this._disposed||"AbortError"===e.name)return;const{error:i,escapeHtml:r}=this.LiveBlade.utils,n=this.LiveBlade.config;if(i("Request failed:",e.message),this.retryCount<n.maxRetries){this.retryCount++;const e=n.retryDelay*this.retryCount;return void setTimeout(()=>{this._disposed||this.load(s,{})},e)}const a=!1===navigator?.onLine;this.el.innerHTML=function(e,t=!1,s){return`\n            <div class="lb-error" role="alert">\n                <div class="lb-error-icon">\n                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                        <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/>\n                        <line x1="12" y1="16" x2="12.01" y2="16"/>\n                    </svg>\n                </div>\n                <strong>Failed to load content</strong>\n                <p>${t?"You appear to be offline.":s(e)}</p>\n                <button type="button" class="lb-retry-btn" data-lb-action="refresh">\n                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                        <path d="M23 4v6h-6M1 20v-6h6"/>\n                        <path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/>\n                    </svg>\n                    Try Again\n                </button>\n            </div>\n        `}(e.message,a,r),this.LiveBlade.bind(this.el),this.el.dispatchEvent(new CustomEvent("lb:error",{detail:{error:e,url:t},bubbles:!0})),this.LiveBlade.emit("error",{controller:this,error:e,url:t,offline:a})},s.prototype.refresh=function(){return this.resetPage(),this.load(!1,{pushState:!0})},s.prototype.navigate=function(e){return e&&this.setUrl(e),this.load(!1,{pushState:!0})},s.prototype.loadMore=function(){const e=parseInt(this.params.page||"1",10);return this.params.page=String(e+1),this.load(!0)},s.prototype.dispose=function(){this._disposed||(this._disposed=!0,this.abortPendingRequest(),this.refreshTimer&&clearInterval(this.refreshTimer),this.LiveBlade.instances.delete(this),this.LiveBlade.controllers.delete(this.el),this.el.removeAttribute("data-lb-bound"))};const i={init(t){t.HtmlController=s,e.addEventListener("popstate",s=>{s.state?.liveblade&&t.instances.forEach(t=>{s.state.path?(t.path=s.state.path,t.params={...s.state.params}):t.setUrl(e.location.href),t.load(!1,{pushState:!1})})}),e.addEventListener("online",()=>{t.emit("online"),t.instances.forEach(e=>{e.retryCount>0&&(e.retryCount=0,e.refresh())})}),e.addEventListener("offline",()=>t.emit("offline"))}};e.LiveBlade&&e.LiveBlade.registerFeature("html-controller",i),"undefined"!=typeof module&&module.exports&&(module.exports={HtmlController:s,HtmlControllerFeature:i})}(window,document),function(e){"use strict";const t={requests:new Map,maxRequests:100,windowMs:6e4,cleanupInterval:null,init(e){this.cleanupInterval||(this.cleanupInterval=setInterval(()=>this.cleanup(),this.windowMs),e.rateLimiter=this)},cleanup(){const e=Date.now();for(const[t,s]of this.requests){const i=s.filter(t=>e-t<this.windowMs);0===i.length?this.requests.delete(t):this.requests.set(t,i)}},canRequest(t){const s=Date.now(),i=(this.requests.get(t)||[]).filter(e=>s-e<this.windowMs);return i.length>=this.maxRequests?(e.LiveBlade&&e.LiveBlade.utils.log("Rate limit exceeded:",t),!1):(i.push(s),this.requests.set(t,i),!0)},reset(e){e?this.requests.delete(e):this.requests.clear()}};e.LiveBlade&&e.LiveBlade.registerFeature("rate-limiter",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={init(e){e.state=this},saveScrollPosition:e=>({top:e.scrollTop,left:e.scrollLeft}),restoreScrollPosition(e,t){t&&(e.scrollTop=t.top,e.scrollLeft=t.left)},saveFocusState(e){const t=document.activeElement;return t&&e.contains(t)?{id:t.id,name:t.name,selectionStart:t.selectionStart,selectionEnd:t.selectionEnd}:null},restoreFocusState(t,s){if(!s)return;const i=e.LiveBlade?.utils?.cssEscape||(e=>e);let r=null;if(s.id&&(r=t.querySelector(`#${i(s.id)}`)),!r&&s.name&&(r=t.querySelector(`[name="${i(s.name)}"]`)),r?.focus&&(r.focus(),null!=s.selectionStart&&r.setSelectionRange))try{r.setSelectionRange(s.selectionStart,s.selectionEnd)}catch{}},saveInputStates(t){const s=t.querySelectorAll("input, textarea, select"),i=[],r=e.LiveBlade?.utils?.cssEscape||(e=>e);return s.forEach(e=>{const t=e.id,s=e.name;let n=null;if(t)n=`#${r(t)}`;else if(s){n=`${e.tagName.toLowerCase()}[name="${r(s)}"]`,"radio"===e.type&&(n+=`[value="${r(e.value)}"]`)}if(!n)return;const a={selector:n,tagName:e.tagName};"checkbox"===e.type?(a.type="checkbox",a.checked=e.checked):"radio"===e.type?(a.type="radio",a.checked=e.checked):"SELECT"===e.tagName?(a.type="select",a.value=e.value,a.selectedIndex=e.selectedIndex,e.multiple&&(a.selectedValues=Array.from(e.selectedOptions).map(e=>e.value))):(a.type="text",a.value=e.value),i.push(a)}),i},restoreInputStates(e,t,s=!0){t?.length&&t.forEach(t=>{const i=e.querySelector(t.selector);i&&(s&&document.activeElement===i||("checkbox"===t.type||"radio"===t.type?i.checked=t.checked:"select"===t.type?t.selectedValues&&i.multiple?Array.from(i.options).forEach(e=>{e.selected=t.selectedValues.includes(e.value)}):(i.value=t.value,i.value!==t.value&&t.selectedIndex>=0&&(i.selectedIndex=t.selectedIndex)):i.value=t.value))})},saveAll(e,t={}){return{scroll:!1!==t.preserveScroll?this.saveScrollPosition(e):null,focus:!1!==t.preserveFocus?this.saveFocusState(e):null,inputs:!1!==t.preserveInputs?this.saveInputStates(e):null}},restoreAll(e,t){t&&(this.restoreScrollPosition(e,t.scroll),this.restoreInputStates(e,t.inputs),this.restoreFocusState(e,t.focus))}};e.LiveBlade&&e.LiveBlade.registerFeature("state",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="html"], [data-lb-html], [data-lb]:not([data-lb="nav"]):not([data-lb="search"]):not([data-lb="filter"]):not([data-lb="button"]):not([data-lb="toggle-update"]):not([data-lb="data"]):not([data-lb="pagination"]):not([data-lb="form"])',bind(e,t){const s=e.getAttribute("data-lb");if(s&&!s.startsWith("/")&&"html"!==s)return;if(t.controllers.has(e))return;if(!t.HtmlController)return void t.utils.warn("HtmlController not available. Include html-controller.js feature.");const i=new t.HtmlController(e,t);t.controllers.set(e,i)}};e.LiveBlade&&e.LiveBlade.registerBinder("html",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="nav"], [data-lb-nav]',bind(e,t){const{sameOrigin:s}=t.utils,i=i=>{if("keydown"===i.type&&"Enter"!==i.key&&" "!==i.key)return;i.preventDefault();const r=t.resolve(e);if(!r)return;const n=e.dataset.lbFetch||e.getAttribute("href");if(!n||!s(n))return;r.setUrl(n),r.refresh();const a=e.closest(".nav, [data-lb-nav-group]");a&&a.querySelectorAll(".active").forEach(e=>e.classList.remove("active")),e.classList.add("active")};e.addEventListener("click",i),e.addEventListener("keydown",i),e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),e.getAttribute("role")||e.setAttribute("role","button")}};e.LiveBlade&&e.LiveBlade.registerBinder("nav",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="search"], [data-lb-search]',bind(e,t){const{debounce:s}=t.utils,i=()=>{const s=t.resolve(e);s&&(s.updateParam(e.name||"search",e.value),s.resetPage(),s.refresh())},r=s(i,t.config.debounce);e.addEventListener("input",r),e.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),i())})}};e.LiveBlade&&e.LiveBlade.registerBinder("search",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:['[data-lb="filter"]',"[data-lb-filter]",'[data-lb="select"]','[data-lb="checkbox"]','[data-lb="radio"]','[data-lb="date"]','[data-lb="time"]','[data-lb="datetime-local"]','[data-lb="month"]','[data-lb="week"]','[data-lb="number"]','[data-lb="range"]','[data-lb="color"]'].join(", "),bind(e,t){const{throttle:s}=t.utils,i=s(()=>{const s=t.resolve(e);if(!s)return;const i=e.name||e.dataset.lbParam||"filter";let r;r="checkbox"===e.type?e.checked?"on"!==e.value?e.value:"1":"":"radio"===e.type?e.checked?e.value:"":e.value,s.updateParam(i,r),s.resetPage(),s.refresh()},t.config.throttle);e.addEventListener("change",i)}};e.LiveBlade&&e.LiveBlade.registerBinder("filter",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:"[data-lb-sort]",bind(e,t){const s=()=>{const s=t.resolve(e);if(!s)return;const i=e.dataset.lbSort,r=s.params.sort===i&&"asc"===s.params.dir?"desc":"asc";s.updateParam("sort",i),s.updateParam("dir",r),s.resetPage();const n=e.closest("table");n&&n.querySelectorAll("[data-lb-sort]").forEach(e=>{e.removeAttribute("aria-sort"),e.classList.remove("lb-sort-asc","lb-sort-desc")}),e.setAttribute("aria-sort","asc"===r?"ascending":"descending"),e.classList.add("asc"===r?"lb-sort-asc":"lb-sort-desc"),s.refresh()};e.addEventListener("click",s),e.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),s())}),e.style.cursor="pointer",e.getAttribute("tabindex")||e.setAttribute("tabindex","0")}};e.LiveBlade&&e.LiveBlade.registerBinder("sort",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="button"], [data-lb-button], [data-lb-action="refresh"], [data-lb-action="load-more"], [data-lb-action="more"]',bind(e,t){const{sameOrigin:s}=t.utils;e.addEventListener("click",i=>{i.preventDefault();const r=t.resolve(e),n=e.dataset.lbAction;if("refresh"===n&&r)return void r.refresh();if(("load-more"===n||"more"===n)&&r)return void r.loadMore();const a=e.dataset.lbFetch;a&&s(a)&&r&&(r.setUrl(a),r.refresh())})}};e.LiveBlade&&e.LiveBlade.registerBinder("button",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="toggle-update"], [data-lb-toggle]',bind(t,s){const{sameOrigin:i,error:r}=s.utils,n=s.config;t.addEventListener("change",async()=>{const a=t.dataset.lbFetch||t.dataset.lbToggle;if(!a||!i(a))return;if(t.dataset.lbConfirm&&!e.confirm(t.dataset.lbConfirm))return void(t.checked=!t.checked);const l=t.closest(".form-check, .form-switch, .lb-toggle"),o=!t.checked;l&&l.classList.add("lb-updating"),t.disabled=!0;try{const e=await fetch(a,{method:t.dataset.lbMethod||"POST",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":s.getCsrf(),"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({[t.name||"value"]:t.checked?1:0}),credentials:"same-origin"});if(!e.ok)throw new Error(`HTTP ${e.status}`);t.disabled=!1,l&&(l.classList.remove("lb-updating"),l.classList.add("lb-success"),setTimeout(()=>l.classList.remove("lb-success"),n.successDuration));const i=s.resolve(t);i&&"false"!==t.dataset.lbRefresh&&i.refresh(),s.emit("toggle:success",{el:t,checked:t.checked})}catch(e){t.checked=o,t.disabled=!1,l&&(l.classList.remove("lb-updating"),l.classList.add("lb-error"),setTimeout(()=>l.classList.remove("lb-error"),n.errorDuration)),r("Toggle failed:",e),s.emit("toggle:error",{el:t,error:e})}})}};e.LiveBlade&&e.LiveBlade.registerBinder("toggle",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="data"], [data-lb-data]',bind(e,t){const{sameOrigin:s}=t.utils,i=e.dataset.lbFetch||e.dataset.lbData;if(!i||!s(i))return;const r=async()=>{try{const s=await fetch(i,{headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":t.getCsrf(),Accept:"application/json"},credentials:"same-origin"});if(!s.ok)throw new Error(`HTTP ${s.status}`);const r=await s.json(),n=r?.value??r?.count??r?.total??Object.values(r||{}).find(e=>"number"==typeof e||"string"==typeof e);void 0!==n&&(e.textContent=n,e.classList.remove("lb-data-error")),t.emit("data:updated",{el:e,data:r})}catch(s){e.classList.add("lb-data-error"),e.textContent||(e.textContent="â€”"),t.emit("data:error",{el:e,error:s})}};r();const n=parseInt(e.dataset.lbInterval,10);n>0&&(e._lbDataTimer=setInterval(r,1e3*n))}};e.LiveBlade&&e.LiveBlade.registerBinder("data",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e){"use strict";const t={selector:'[data-lb="pagination"], [data-lb-pagination]',bind(e,t){const{sameOrigin:s}=t.utils;e.addEventListener("click",i=>{let r=i.target;if("A"!==r.tagName&&(r=r.closest("a")),!r?.href||"#"===r.href||r.classList.contains("disabled"))return;i.preventDefault(),i.stopPropagation();const n=t.resolve(e);n&&s(r.href)&&(n.setUrl(r.href),n.navigate())})}};e.LiveBlade&&e.LiveBlade.registerBinder("pagination",t),"undefined"!=typeof module&&module.exports&&(module.exports=t)}(window),function(e,t){"use strict";function s(e){return e.title??e.text??e.name??e.label??""}function i(e){return e.subtitle??e.description??e.email??""}function r(e){const t=s(e),r=i(e);let n='<div class="lb-qs-content">';return n+=`<div class="lb-qs-title">${a(t)}</div>`,r&&(n+=`<div class="lb-qs-subtitle">${a(r)}</div>`),n+="</div>",n}function n(e){const t=s(e),r=i(e),n=function(e){return e.picture??e.avatar??e.image??e.img??""}(e),l=t.split(" ").map(e=>e[0]).join("").substring(0,2).toUpperCase();let o;return o=n?`<img src="${a(n)}" alt="" class="lb-qs-picture">`:`<div class="lb-qs-picture lb-qs-initials">${l}</div>`,`\n            ${o}\n            <div class="lb-qs-content">\n                <div class="lb-qs-title">${a(t)}</div>\n                ${r?`<div class="lb-qs-subtitle">${a(r)}</div>`:""}\n            </div>\n        `}function a(e){return null==e?"":String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function l(e,s){this.input=e,this.LiveBlade=s,this.url=e.dataset.lbQuickSearch,this.targetSelector=e.dataset.lbTarget,this.target=t.querySelector(this.targetSelector),this.minChars=parseInt(e.dataset.lbMin,10)||1,this.delay=parseInt(e.dataset.lbDelay,10)||300,this.paramName=e.dataset.lbParam||"q",this.hiddenSelector=e.dataset.lbHidden,this.displayProp=e.dataset.lbDisplay||"title",this.template=e.dataset.lbTemplate||"default",this.abortController=null,this.debounceTimer=null,this.selectedIndex=-1,this.items=[],this.isOpen=!1,this._init()}l.prototype._init=function(){if(this.target){if(this.target.classList.add("lb-quick-search-results"),this.input.classList.add("lb-quick-search-input"),!this.input.parentElement.classList.contains("lb-quick-search-wrapper")){const e=t.createElement("div");e.className="lb-quick-search-wrapper",this.input.parentNode.insertBefore(e,this.input),e.appendChild(this.input),e.appendChild(this.target)}this.input.addEventListener("input",this._onInput.bind(this)),this.input.addEventListener("keydown",this._onKeydown.bind(this)),this.input.addEventListener("focus",this._onFocus.bind(this)),this.input.addEventListener("blur",this._onBlur.bind(this)),this.target.addEventListener("mousedown",this._onResultClick.bind(this)),this.input.setAttribute("role","combobox"),this.input.setAttribute("aria-autocomplete","list"),this.input.setAttribute("aria-expanded","false"),this.target.setAttribute("role","listbox")}else this.LiveBlade.utils.warn("Quick Search: Target not found:",this.targetSelector)},l.prototype._onInput=function(e){const t=e.target.value.trim();this._clearHidden(),t.length<this.minChars?this._hideResults():(clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>this._search(t),this.delay))},l.prototype._onKeydown=function(e){if(this.isOpen)switch(e.key){case"ArrowDown":e.preventDefault(),this._navigate(1);break;case"ArrowUp":e.preventDefault(),this._navigate(-1);break;case"Enter":e.preventDefault(),this.selectedIndex>=0&&this._selectItem(this.items[this.selectedIndex]);break;case"Escape":e.preventDefault(),this._hideResults();break;case"Tab":this._hideResults()}else"ArrowDown"===e.key&&this.input.value.length>=this.minChars&&this._search(this.input.value.trim())},l.prototype._onFocus=function(){this.items.length>0&&this.input.value.length>=this.minChars&&this._showResults()},l.prototype._onBlur=function(){setTimeout(()=>this._hideResults(),150)},l.prototype._onResultClick=function(e){const t=e.target.closest(".lb-qs-item");if(!t)return;e.preventDefault();const s=parseInt(t.dataset.index,10);this.items[s]&&this._selectItem(this.items[s])},l.prototype._search=async function(t){this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const s=new URL(this.url,e.location.href);s.searchParams.set(this.paramName,t),this.input.classList.add("lb-qs-loading");try{const e=await fetch(s.toString(),{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":this.LiveBlade.getCsrf()},credentials:"same-origin",signal:this.abortController.signal});if(!e.ok)throw new Error(`HTTP ${e.status}`);const i=await e.json();this.items=Array.isArray(i)?i:i.data??i.results??i.items??[],this._renderResults(),this._showResults(),this.LiveBlade.emit("quicksearch:results",{input:this.input,query:t,items:this.items})}catch(e){if("AbortError"===e.name)return;this.LiveBlade.utils.error("Quick Search error:",e),this._hideResults()}finally{this.input.classList.remove("lb-qs-loading")}},l.prototype._renderResults=function(){if(0===this.items.length)return void(this.target.innerHTML='<div class="lb-qs-empty">No results found</div>');const e="avatar"===this.template?n:r;this.target.innerHTML=this.items.map((t,s)=>{const i=e(t);return`\n                <div class="lb-qs-item" data-index="${s}" data-id="${a(t.id??"")}" role="option">\n                    ${i}\n                </div>\n            `}).join(""),this.selectedIndex=-1},l.prototype._navigate=function(e){const t=this.target.querySelectorAll(".lb-qs-item");if(0===t.length)return;this.selectedIndex>=0&&t[this.selectedIndex]&&t[this.selectedIndex].classList.remove("lb-qs-active"),this.selectedIndex+=e,this.selectedIndex<0&&(this.selectedIndex=t.length-1),this.selectedIndex>=t.length&&(this.selectedIndex=0);const s=t[this.selectedIndex];s.classList.add("lb-qs-active"),s.scrollIntoView({block:"nearest"}),this.input.setAttribute("aria-activedescendant",`lb-qs-item-${this.selectedIndex}`)},l.prototype._selectItem=function(e){const s=e[this.displayProp]??e.title??e.text??e.name??e.label??"";if(this.input.value=s,this.hiddenSelector){const s=t.querySelector(this.hiddenSelector);s&&(s.value=e.id??"")}this._hideResults(),this.LiveBlade.emit("quicksearch:select",{input:this.input,item:e}),this.input.dispatchEvent(new CustomEvent("lb:quicksearch:select",{detail:{item:e},bubbles:!0}))},l.prototype._showResults=function(){(0!==this.items.length||this.target.innerHTML)&&(this.target.classList.add("lb-qs-open"),this.input.setAttribute("aria-expanded","true"),this.isOpen=!0)},l.prototype._hideResults=function(){this.target.classList.remove("lb-qs-open"),this.input.setAttribute("aria-expanded","false"),this.isOpen=!1,this.selectedIndex=-1},l.prototype._clearHidden=function(){if(this.hiddenSelector){const e=t.querySelector(this.hiddenSelector);e&&(e.value="")}},l.prototype.clear=function(){this.input.value="",this._clearHidden(),this._hideResults(),this.items=[]};const o={init(e){e.QuickSearchController=l}},d={selector:"[data-lb-quick-search]",bind(e,t){e._lbQuickSearch||(e._lbQuickSearch=new l(e,t))}};e.LiveBlade&&(e.LiveBlade.registerFeature("quick-search",o),e.LiveBlade.registerBinder("quick-search",d)),"undefined"!=typeof module&&module.exports&&(module.exports={QuickSearchController:l,QuickSearchFeature:o,QuickSearchBinder:d})}(window,document),function(e,t){"use strict";function s(e,s){this.parent=e,this.LiveBlade=s,this.urlTemplate=e.dataset.lbFetch,this.targetSelector=e.dataset.lbTarget,this.child=t.querySelector(this.targetSelector),this.placeholder=e.dataset.lbPlaceholder||"Select...",this.loadingText=e.dataset.lbLoading||"Loading...",this.errorText=e.dataset.lbError||"Error loading options",this.valueField=e.dataset.lbValueField||"id",this.textField=e.dataset.lbTextField||"name",this.preselectedValue=e.dataset.lbSelected||null,this.abortController=null,this.originalPlaceholder=null,this.cache={},this._init()}s.prototype._init=function(){this.child?this.urlTemplate?(this.child.options.length>0&&""===this.child.options[0].value?this.originalPlaceholder=this.child.options[0].text:this.originalPlaceholder=this.placeholder,this.parent.value?this._loadOptions(this.parent.value):this._resetChild(),this.parent.addEventListener("change",this._onChange.bind(this))):console.warn("LiveBlade Cascade: data-lb-fetch is required"):console.warn("LiveBlade Cascade: Target not found:",this.targetSelector)},s.prototype._onChange=function(e){const t=e.target.value;t?this._loadOptions(t):this._resetChild()},s.prototype._loadOptions=async function(e){if(this.cache[e])return void this._populateOptions(this.cache[e]);this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const t=this.urlTemplate.replace("{value}",encodeURIComponent(e));this._setLoading(!0),this._emit("lb:cascade:loading",{parent:this.parent,child:this.child,value:e});try{const s=await fetch(t,{method:"GET",headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest","X-CSRF-TOKEN":this.LiveBlade.getCsrf()},credentials:"same-origin",signal:this.abortController.signal});if(!s.ok)throw new Error(`HTTP ${s.status}`);const i=await s.json(),r=Array.isArray(i)?i:i.data??i.options??i.items??[];this.cache[e]=r,this._populateOptions(r),this._emit("lb:cascade:loaded",{parent:this.parent,child:this.child,value:e,options:r})}catch(e){if("AbortError"===e.name)return;console.error("LiveBlade Cascade error:",e),this._setError(),this._emit("lb:cascade:error",{parent:this.parent,child:this.child,error:e})}},s.prototype._populateOptions=function(e){this.child.innerHTML="";const s=t.createElement("option");s.value="",s.textContent=this.originalPlaceholder,this.child.appendChild(s),e.forEach(e=>{const s=t.createElement("option");s.value=e[this.valueField]??e.id??e.value??"",s.textContent=e[this.textField]??e.name??e.text??e.label??"",this.preselectedValue&&s.value===this.preselectedValue&&(s.selected=!0,this.preselectedValue=null),this.child.appendChild(s)}),this.child.disabled=!1,this.child.classList.remove("lb-cascade-loading","lb-cascade-error"),this.child.value&&this.child.dispatchEvent(new Event("change",{bubbles:!0}))},s.prototype._resetChild=function(){this.child.innerHTML="";const e=t.createElement("option");e.value="",e.textContent=this.originalPlaceholder,this.child.appendChild(e),this.child.disabled=!0,this.child.classList.remove("lb-cascade-loading","lb-cascade-error"),this._emit("lb:cascade:reset",{parent:this.parent,child:this.child}),void 0!==this.child.dataset.lbCascade&&this.child.dispatchEvent(new Event("change",{bubbles:!0}))},s.prototype._setLoading=function(e){if(e){this.child.disabled=!0,this.child.classList.add("lb-cascade-loading"),this.child.classList.remove("lb-cascade-error"),this.child.innerHTML="";const e=t.createElement("option");e.value="",e.textContent=this.loadingText,this.child.appendChild(e)}},s.prototype._setError=function(){this.child.disabled=!0,this.child.classList.remove("lb-cascade-loading"),this.child.classList.add("lb-cascade-error"),this.child.innerHTML="";const e=t.createElement("option");e.value="",e.textContent=this.errorText,this.child.appendChild(e)},s.prototype._emit=function(e,t){this.parent.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0})),this.child.dispatchEvent(new CustomEvent(e,{detail:t,bubbles:!0}))},s.prototype.clearCache=function(){this.cache={}},s.prototype.reload=function(){const e=this.parent.value;e&&(delete this.cache[e],this._loadOptions(e))};const i={init(e){e.CascadeController=s}},r={selector:"[data-lb-cascade]",bind(e,t){e._lbCascade||(e._lbCascade=new s(e,t))}};e.LiveBlade&&(e.LiveBlade.registerFeature("cascade",i),e.LiveBlade.registerBinder("cascade",r)),"undefined"!=typeof module&&module.exports&&(module.exports={CascadeController:s,CascadeFeature:i,CascadeBinder:r})}(window,document);